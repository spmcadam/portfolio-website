<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Rocket Simulation Demo</title>

  <!-- PyScript CSS/JS from the official CDN -->
  <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
  <script defer src="https://pyscript.net/latest/pyscript.js"></script>

  <style>
    body {
      font-family: sans-serif;
      margin: 20px;
    }
    .param-row {
      margin-bottom: 1em;
    }
    button {
      margin-top: 1em;
      padding: 0.5em 1em;
    }
    #plot-container {
      margin-top: 2em;
    }
  </style>
</head>
<body>

<h1>Starship Launch Simulation</h1>
<p>
  Enter parameters, then click "Run Simulation":
</p>
<ul>
  <li>Altitude vs Time</li>
  <li>Velocity Components vs Time</li>
  <li>Total Velocity vs Time</li>
</ul>

<!-- 1) PyScript environment: specify needed packages. -->
<py-env>
  - numpy
  - pandas
  - matplotlib
</py-env>

<!-- 2) Load your rocket.py code but keep it hidden from view. -->
<py-script src="rocket.py" hidden></py-script>

<!-- 3) Simple form for parameters. -->
<div class="param-row">
  <label>Vertical velocity before pitch (m/s): 
    <input type="number" id="vert_v0" value="25" step="1" />
  </label>
</div>
<div class="param-row">
  <label>Final pitch stage1 (deg):
    <input type="number" id="final_pitch_stage1" value="70" step="1" />
  </label>
</div>
<div class="param-row">
  <label>Final pitch stage2 (deg):
    <input type="number" id="final_pitch_stage2" value="90" step="1" />
  </label>
</div>
<div class="param-row">
  <label>% burntime stage2 (0.65 default):
    <input type="number" id="perc_burntime2" value="0.65" step="0.01" />
  </label>
</div>
<div class="param-row">
  <label>Coast time (s):
    <input type="number" id="coast_time" value="60" step="1" />
  </label>
</div>

<button onclick="runSimulation()">Run Simulation</button>

<!-- 4) Container where the plot image will be inserted -->
<div id="plot-container">
  <!-- Will display an <img> tag here after running simulation -->
</div>

<script>
async function runSimulation() {
  // Read parameter values from the form
  const v0    = document.getElementById("vert_v0").value;
  const p1    = document.getElementById("final_pitch_stage1").value;
  const p2    = document.getElementById("final_pitch_stage2").value;
  const burn  = document.getElementById("perc_burntime2").value;
  const coast = document.getElementById("coast_time").value;

  // Build a *multi-line* Python command string
  const command = `
result = run_simulation('${v0}', '${p1}', '${p2}', '${burn}', '${coast}')
pyscript.write("plot-container", result)
`;

  // Execute that command in PyScript's Python environment
  await runPythonAsync(command);
}
</script>

</body>
</html>

